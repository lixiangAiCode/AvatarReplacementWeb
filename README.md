# ğŸ­ èŠå¤©å¤´åƒæ›¿æ¢å·¥å…· - Webç‰ˆæœ¬

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Vue.js](https://img.shields.io/badge/Vue.js-3.4+-green.svg)](https://vuejs.org/)
[![Element Plus](https://img.shields.io/badge/Element%20Plus-2.4+-blue.svg)](https://element-plus.org/)

> ä¸€ä¸ªåŸºäºæ¨¡æ¿åŒ¹é…çš„æ™ºèƒ½å¤´åƒæ‰¹é‡æ›¿æ¢å·¥å…·ï¼Œæ”¯æŒä»èŠå¤©è®°å½•æˆªå›¾ä¸­è‡ªåŠ¨è¯†åˆ«å¹¶æ›¿æ¢å¤´åƒã€‚

## âœ¨ åŠŸèƒ½ç‰¹è‰²

- ğŸ–¼ï¸ **æ™ºèƒ½å›¾ç‰‡ä¸Šä¼ ** - æ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼Œå®æ—¶é¢„è§ˆ
- ğŸ¯ **ç²¾å‡†æ¨¡æ¿é€‰æ‹©** - å¯è§†åŒ–Canvasæ¡†é€‰å¤´åƒåŒºåŸŸ
- âš™ï¸ **çµæ´»å‚æ•°è°ƒèŠ‚** - é¢„è®¾é…ç½®å’Œè‡ªå®šä¹‰å‚æ•°
- ğŸ“Š **å®æ—¶å¤„ç†è¿›åº¦** - åŠ¨æ€æ˜¾ç¤ºå¤„ç†çŠ¶æ€å’Œè¿›åº¦
- ğŸ¨ **ç°ä»£åŒ–UIè®¾è®¡** - å“åº”å¼è®¾è®¡ï¼Œæ¯›ç»ç’ƒæ•ˆæœ
- ğŸ”„ **æ­¥éª¤å¼å¼•å¯¼** - æ¸…æ™°çš„æ“ä½œæµç¨‹æŒ‡å¯¼

## ğŸ¬ åŠŸèƒ½æ¼”ç¤º

![å¤´åƒæ›¿æ¢æµç¨‹](docs/images/demo-workflow.gif)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: Vue 3 (Composition API)
- **æ„å»ºå·¥å…·**: Vite 5.0
- **UIç»„ä»¶åº“**: Element Plus 2.4
- **çŠ¶æ€ç®¡ç†**: Pinia 2.1
- **HTTPå®¢æˆ·ç«¯**: Axios 1.6
- **Canvasäº¤äº’**: Konva.js 9.2
- **å›¾æ ‡**: Element Plus Icons

### åç«¯æŠ€æœ¯
- **æ¡†æ¶**: FastAPI
- **å›¾åƒå¤„ç†**: OpenCV
- **å¼‚æ­¥æ”¯æŒ**: Uvicorn
- **ä¼šè¯ç®¡ç†**: åŸºäºUUIDçš„ä¼šè¯ç³»ç»Ÿ
- **æ–‡ä»¶å­˜å‚¨**: æœ¬åœ°å­˜å‚¨
- **APIè·¯ç”±**: æ¨¡å—åŒ–è·¯ç”±è®¾è®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
å¤´åƒæ›¿æ¢web/
â”œâ”€â”€ frontend/                 # Vue.js å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/       # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageUpload.vue       # å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ TemplateSelector.vue  # Canvasæ¨¡æ¿é€‰æ‹©
â”‚   â”‚   â”‚   â”œâ”€â”€ ParameterPanel.vue    # å‚æ•°è°ƒèŠ‚é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ ResultPreview.vue     # ç»“æœå±•ç¤ºç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”‚   â””â”€â”€ AvatarReplace.vue     # ä¸»é¡µé¢
â”‚   â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”‚   â””â”€â”€ app.js                # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ request.js            # Axioså°è£…
â”‚   â”‚   â”‚   â”œâ”€â”€ session.js            # ä¼šè¯ç®¡ç†API
â”‚   â”‚   â”‚   â””â”€â”€ upload.js             # ä¸Šä¼ å¤„ç†API
â”‚   â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â”‚   â””â”€â”€ index.js              # Vue Routeré…ç½®
â”‚   â”‚   â”œâ”€â”€ App.vue                   # æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.js                   # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”‚   â”œâ”€â”€ index.html                    # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ package.json                  # å‰ç«¯ä¾èµ–é…ç½®
â”‚   â””â”€â”€ vite.config.js               # Viteæ„å»ºé…ç½®
â”œâ”€â”€ backend/                  # FastAPI åç«¯åº”ç”¨
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ models.py                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ session_manager.py       # ä¼šè¯ç®¡ç†
â”‚   â”‚   â””â”€â”€ routers/                  # APIè·¯ç”±
â”‚   â”‚       â”œâ”€â”€ session.py           # ä¼šè¯ç›¸å…³API
â”‚   â”‚       â””â”€â”€ upload.py            # æ–‡ä»¶ä¸Šä¼ API
â”‚   â”œâ”€â”€ modules/              # å›¾åƒå¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ avatar_detector.py       # å¤´åƒæ£€æµ‹ç®—æ³•
â”‚   â”‚   â”œâ”€â”€ avatar_replacer.py       # å¤´åƒæ›¿æ¢å¤„ç†
â”‚   â”‚   â”œâ”€â”€ right_side_filter.py     # å³ä¾§æ¶ˆæ¯è¿‡æ»¤
â”‚   â”‚   â””â”€â”€ web_adapter.py           # Webé€‚é…å™¨
â”‚   â”œâ”€â”€ main.py               # FastAPIåº”ç”¨å…¥å£
â”‚   â””â”€â”€ requirements.txt      # åç«¯ä¾èµ–
â””â”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
    â”œâ”€â”€ api.md               # APIæ¥å£æ–‡æ¡£
    â”œâ”€â”€ components.md        # ç»„ä»¶ä½¿ç”¨æ–‡æ¡£
    â””â”€â”€ deployment.md        # éƒ¨ç½²æŒ‡å—
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

**å‰ç«¯ç¯å¢ƒï¼š**
- Node.js >= 16.0.0
- npm >= 8.0.0 æˆ– yarn >= 1.22.0

**åç«¯ç¯å¢ƒï¼š**
- Python >= 3.8
- pip >= 21.0
- OpenCV ç›¸å…³ä¾èµ–

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/lixiangAiCode/AvatarReplacementWeb.git
   cd AvatarReplacementWeb
   ```

2. **å®‰è£…åç«¯ä¾èµ–**
   ```bash
   cd backend
   pip install -r requirements.txt
   ```

3. **å¯åŠ¨åç«¯æœåŠ¡**
   ```bash
   uvicorn main:app --reload --host 0.0.0.0 --port 8000
   ```

4. **å®‰è£…å‰ç«¯ä¾èµ–**
   ```bash
   cd ../frontend
   npm install
   ```

5. **å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

6. **è®¿é—®åº”ç”¨**
   ```
   å‰ç«¯: http://localhost:3000
   åç«¯API: http://localhost:8000
   ```

### ç”Ÿäº§æ„å»º

**å‰ç«¯æ„å»ºï¼š**
```bash
cd frontend
npm run build
```

**åç«¯éƒ¨ç½²ï¼š**
```bash
cd backend
uvicorn main:app --host 0.0.0.0 --port 8000
```

æ„å»ºäº§ç‰©å°†ç”Ÿæˆåœ¨ `frontend/dist` ç›®å½•ä¸­ã€‚

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. ä¸Šä¼ å›¾ç‰‡
- ğŸ“± ä¸Šä¼ èŠå¤©è®°å½•æˆªå›¾ï¼ˆæ”¯æŒæ‹–æ‹½ï¼‰
- ğŸ‘¤ ä¸Šä¼ æ–°çš„å¤´åƒå›¾ç‰‡
- âœ… ç­‰å¾…ä¸Šä¼ å®Œæˆç¡®è®¤

### 2. é€‰æ‹©æ¨¡æ¿
- ğŸ¯ åœ¨èŠå¤©æˆªå›¾ä¸­æ¡†é€‰éœ€è¦æ›¿æ¢çš„å¤´åƒåŒºåŸŸ
- ğŸ“ æ”¯æŒå¤šä¸ªå¤´åƒåŒºåŸŸé€‰æ‹©
- ğŸ”§ å¯è°ƒæ•´é€‰æ‹©æ¡†çš„ä½ç½®å’Œå¤§å°

### 3. å‚æ•°è°ƒèŠ‚
- âš™ï¸ é€‰æ‹©é¢„è®¾é…ç½®æˆ–è‡ªå®šä¹‰å‚æ•°
- ğŸ¨ è°ƒæ•´åŒ¹é…ç²¾åº¦ã€è¾¹ç¼˜ç¾½åŒ–ç­‰é€‰é¡¹
- ğŸš€ å¼€å§‹å¤„ç†ä»»åŠ¡

### 4. æŸ¥çœ‹ç»“æœ
- ğŸ“Š å®æ—¶æŸ¥çœ‹å¤„ç†è¿›åº¦
- ğŸ–¼ï¸ é¢„è§ˆæ›¿æ¢æ•ˆæœ
- ğŸ’¾ ä¸‹è½½å¤„ç†åçš„å›¾ç‰‡

## ğŸ”§ é…ç½®è¯´æ˜

### å¼€å‘ç¯å¢ƒé…ç½®

åœ¨ `frontend/vite.config.js` ä¸­å¯ä»¥é…ç½®ï¼š

```javascript
export default defineConfig({
  server: {
    host: '0.0.0.0',
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',  // åç«¯APIåœ°å€
        changeOrigin: true,
      }
    }
  }
})
```

### API ä»£ç†é…ç½®

å‰ç«¯å¼€å‘æ—¶ï¼ŒAPIè¯·æ±‚ä¼šä»£ç†åˆ°åç«¯æœåŠ¡å™¨ï¼š
- å‰ç«¯: `http://localhost:3000`
- åç«¯: `http://localhost:8000`

## ğŸ¨ ç»„ä»¶è¯´æ˜

### ImageUpload ç»„ä»¶
è´Ÿè´£å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼Œæ”¯æŒï¼š
- æ‹–æ‹½ä¸Šä¼ 
- æ–‡ä»¶æ ¼å¼éªŒè¯
- å®æ—¶é¢„è§ˆ
- ä¸Šä¼ è¿›åº¦æ˜¾ç¤º

### TemplateSelector ç»„ä»¶
Canvaså¤´åƒåŒºåŸŸé€‰æ‹©ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼š
- å¯è§†åŒ–æ¡†é€‰
- å¤šåŒºåŸŸé€‰æ‹©
- ç²¾ç¡®å®šä½
- å®æ—¶åé¦ˆ

### ParameterPanel ç»„ä»¶
å‚æ•°é…ç½®é¢æ¿ï¼Œæä¾›ï¼š
- é¢„è®¾æ¨¡æ¿
- è‡ªå®šä¹‰å‚æ•°
- å®æ—¶é¢„è§ˆ
- å‚æ•°ä¿å­˜

### ResultPreview ç»„ä»¶
ç»“æœå±•ç¤ºç»„ä»¶ï¼Œæ”¯æŒï¼š
- å¯¹æ¯”æ˜¾ç¤º
- ä¸‹è½½åŠŸèƒ½
- è´¨é‡è¯„ä¼°
- æ‰¹é‡æ“ä½œ

## ğŸ“ API æ¥å£

### ä¼šè¯ç®¡ç†
- `POST /api/session/create` - åˆ›å»ºæ–°ä¼šè¯
- `GET /api/session/{id}/status` - è·å–ä¼šè¯çŠ¶æ€

### æ–‡ä»¶ä¸Šä¼ 
- `POST /api/upload/chat` - ä¸Šä¼ èŠå¤©æˆªå›¾
- `POST /api/upload/avatar` - ä¸Šä¼ æ–°å¤´åƒ

### å›¾åƒå¤„ç†
- `POST /api/process/start` - å¼€å§‹å¤„ç†ä»»åŠ¡
- `GET /api/process/{id}/result` - è·å–å¤„ç†ç»“æœ

è¯¦ç»†APIæ–‡æ¡£è¯·æŸ¥çœ‹ï¼š[APIæ¥å£æ–‡æ¡£](docs/api.md)

## ğŸ¯ å¼€å‘è·¯çº¿å›¾

### å·²å®Œæˆ âœ…
- [x] å‰ç«¯æ¡†æ¶æ­å»º
- [x] åŸºç¡€ç»„ä»¶å¼€å‘
- [x] çŠ¶æ€ç®¡ç†å®ç°
- [x] UIç•Œé¢è®¾è®¡
- [x] åç«¯APIå¼€å‘
- [x] å›¾åƒå¤„ç†ç®—æ³•
- [x] å‰åç«¯è”è°ƒ
- [x] ä¼šè¯ç®¡ç†ç³»ç»Ÿ
- [x] æ–‡ä»¶ä¸Šä¼ å¤„ç†
- [x] å¤´åƒæ£€æµ‹ä¸æ›¿æ¢

### ä¼˜åŒ–ä¸­ ğŸš§
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] ç”¨æˆ·ä½“éªŒæå‡

### è®¡åˆ’ä¸­ ğŸ“‹
- [ ] æ‰¹é‡å¤„ç†åŠŸèƒ½
- [ ] æ¨¡æ¿ä¿å­˜/åŠ è½½
- [ ] ç”¨æˆ·åå¥½è®¾ç½®
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] Dockerå®¹å™¨åŒ–éƒ¨ç½²
- [ ] äº‘å­˜å‚¨é›†æˆ

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼

1. **Fork** æœ¬é¡¹ç›®
2. **åˆ›å»º** ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. **æäº¤** æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. **æ¨é€** åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. **æ‰“å¼€** Pull Request

### å¼€å‘è§„èŒƒ

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ª Vue 3 ç»„åˆå¼APIè§„èŒƒ
- æäº¤ä¿¡æ¯éµå¾ª [Conventional Commits](https://conventionalcommits.org/)
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [MIT License](LICENSE) å¼€æºåè®®ã€‚

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®åœ°å€**: [GitHub Repository](https://github.com/lixiangAiCode/AvatarReplacementWeb)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/lixiangAiCode/AvatarReplacementWeb/issues)
- **åŠŸèƒ½å»ºè®®**: [Discussions](https://github.com/lixiangAiCode/AvatarReplacementWeb/discussions)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Vue.js](https://vuejs.org/) - æ¸è¿›å¼JavaScriptæ¡†æ¶
- [Element Plus](https://element-plus.org/) - Vue 3ç»„ä»¶åº“
- [Vite](https://vitejs.dev/) - ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·
- [Konva.js](https://konvajs.org/) - 2D Canvasåº“

---

<div align="center">
  <p>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸</p>
  <p>Made with â¤ï¸ by LixiangAI</p>
</div>
